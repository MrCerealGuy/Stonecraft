/* WARNING: This file was automatically generated by lua2c. */

#ifdef __cplusplus
extern "C" {
#endif
#include <lua.h>
#include <lauxlib.h>
#include <lualib.h>
#ifdef __cplusplus
}
#endif
#include <stdio.h>
#include <stdlib.h>


#include <string.h>


#include <assert.h>

/* name: (main)
 * function(...) */
static int lcf_main (lua_State * L) {
  enum { lc_nformalargs = 0 };
  const int lc_nactualargs = lua_gettop(L);
  const int lc_nextra = (lc_nactualargs - lc_nformalargs);
  
  /* --[[
   * 
   * 
   * 2016-05-03 modified by MrCerealGuy <mrcerealguy@gmx.de>
   * 	removed flying_duck
   * 
   * --]] 
   * -- Spawning parameters
   * -- ANTS
   * nssm:spawn_specific("nssm:ant_queen", {"nssm:ant_dirt"}, {"air"}, 0, 20, 60, 200, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:ant_queen");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"nssm:ant_dirt");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,60);
  lua_pushnumber(L,200);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:ant_soldier", {"nssm:ant_dirt"}, {"air"}, 0, 20, 7, 30, 4, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:ant_soldier");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"nssm:ant_dirt");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,7);
  lua_pushnumber(L,30);
  lua_pushnumber(L,4);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:ant_worker", {"nssm:ant_dirt"}, {"air"}, 0, 20, 5, 10, 5, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:ant_worker");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"nssm:ant_dirt");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,5);
  lua_pushnumber(L,10);
  lua_pushnumber(L,5);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* -- SPIDERS
   * nssm:spawn_specific("nssm:black_widow", {"default:jungle_grass", "default:jungletree", "nssm:web" }, {"air"}, 0, 20, 20, 1000, 2, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:black_widow");
  lua_createtable(L,3,0);
  lua_pushliteral(L,"default:jungle_grass");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:jungletree");
  lua_rawseti(L,-2,2);
  lua_pushliteral(L,"nssm:web");
  lua_rawseti(L,-2,3);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,20);
  lua_pushnumber(L,1000);
  lua_pushnumber(L,2);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:daddy_long_legs", {"default:jungle_grass", "default:jungletree", "nssm:web" }, {"air"}, 0, 20, 10, 1000, 2, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:daddy_long_legs");
  lua_createtable(L,3,0);
  lua_pushliteral(L,"default:jungle_grass");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:jungletree");
  lua_rawseti(L,-2,2);
  lua_pushliteral(L,"nssm:web");
  lua_rawseti(L,-2,3);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,10);
  lua_pushnumber(L,1000);
  lua_pushnumber(L,2);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:tarantula", {"default:jungle_grass", "default:jungletree", "nssm:web" }, {"air"}, 0, 14, 120, 5000, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:tarantula");
  lua_createtable(L,3,0);
  lua_pushliteral(L,"default:jungle_grass");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:jungletree");
  lua_rawseti(L,-2,2);
  lua_pushliteral(L,"nssm:web");
  lua_rawseti(L,-2,3);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,14);
  lua_pushnumber(L,120);
  lua_pushnumber(L,5000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:uloboros", {"default:jungle_grass", "default:jungletree", "nssm:web" }, {"air"}, 0, 20, 20, 1000, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:uloboros");
  lua_createtable(L,3,0);
  lua_pushliteral(L,"default:jungle_grass");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:jungletree");
  lua_rawseti(L,-2,2);
  lua_pushliteral(L,"nssm:web");
  lua_rawseti(L,-2,3);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,20);
  lua_pushnumber(L,1000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* -- CAVES
   * nssm:spawn_specific("nssm:bloco", {"default:stone"}, {"default:stone"}, 0, 20, 30, 500, 3, -31000, -20) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:bloco");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:stone");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:stone");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,30);
  lua_pushnumber(L,500);
  lua_pushnumber(L,3);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,-20);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:lava_titan", {"default:stone"}, {"air"}, 0, 120, 12, 8000, 1, -31000, -50) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:lava_titan");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:stone");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,120);
  lua_pushnumber(L,12);
  lua_pushnumber(L,8000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,-50);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:stone_eater", {"default:stone"}, {"default:stone"}, 0, 20, 40, 700, 2, -31000, -20) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:stone_eater");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:stone");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:stone");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,40);
  lua_pushnumber(L,700);
  lua_pushnumber(L,2);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,-20);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:signosigno", {"default:stone"}, {"default:stone"}, 0, 10, 20, 400, 2, -31000, -20) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:signosigno");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:stone");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:stone");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,10);
  lua_pushnumber(L,20);
  lua_pushnumber(L,400);
  lua_pushnumber(L,2);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,-20);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:signosigno", {"bones:bones"}, {"air"}, 0, 15, 3, 1, 5, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:signosigno");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"bones:bones");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,15);
  lua_pushnumber(L,3);
  lua_pushnumber(L,1);
  lua_pushnumber(L,5);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* -- SEA
   * nssm:spawn_specific("nssm:crab", {"default:sand"}, {"default:water_source"}, 0, 20, 20, 3000, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:crab");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:sand");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:water_source");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,20);
  lua_pushnumber(L,3000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:crocodile", {"default:sand","default:water_source"}, {"default:water_source"}, 0, 20, 60, 35000, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:crocodile");
  lua_createtable(L,2,0);
  lua_pushliteral(L,"default:sand");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:water_source");
  lua_rawseti(L,-2,2);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:water_source");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,60);
  lua_pushnumber(L,35000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:dolidrosaurus", {"default:water_source"}, {"default:water_source"}, 0, 20, 60, 35000, 1, -31000, -1) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:dolidrosaurus");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:water_source");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:water_source");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,60);
  lua_pushnumber(L,35000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,-1);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:kraken", {"default:water_source"}, {"default:water_source"}, 0, 20, 120, 90000, 1, -31000, 0) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:kraken");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:water_source");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:water_source");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,120);
  lua_pushnumber(L,90000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,0);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:octopus", {"default:water_source"}, {"default:water_source"}, 0, 20, 60, 40000, 1, -31000, 0) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:octopus");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:water_source");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:water_source");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,60);
  lua_pushnumber(L,40000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,0);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* -- DESERT
   * nssm:spawn_specific("nssm:sandworm", {"default:desert_sand", "default:desert_stone"}, {"air"}, 0, 20, 20, 30000, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:sandworm");
  lua_createtable(L,2,0);
  lua_pushliteral(L,"default:desert_sand");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:desert_stone");
  lua_rawseti(L,-2,2);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,20);
  lua_pushnumber(L,30000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:giant_sandworm", {"default:desert_sand", "default:desert_stone"}, {"air"}, 0, 20, 1200, 40000, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:giant_sandworm");
  lua_createtable(L,2,0);
  lua_pushliteral(L,"default:desert_sand");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:desert_stone");
  lua_rawseti(L,-2,2);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,1200);
  lua_pushnumber(L,40000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:sand_bloco", {"default:desert_sand", "default:desert_stone"}, {"air"}, 0, 20, 20, 30000, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:sand_bloco");
  lua_createtable(L,2,0);
  lua_pushliteral(L,"default:desert_sand");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:desert_stone");
  lua_rawseti(L,-2,2);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,20);
  lua_pushnumber(L,30000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* -- DUCKS
   * nssm:spawn_specific("nssm:duck", {"default:dirt_with_grass"}, {"group:flora"}, 10, 20, 20, 200, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:duck");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"group:flora");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,10);
  lua_pushnumber(L,20);
  lua_pushnumber(L,20);
  lua_pushnumber(L,200);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:duckking", {"default:dirt_with_grass"}, {"group:flora"}, 10, 20, 120, 3000, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:duckking");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"group:flora");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,10);
  lua_pushnumber(L,20);
  lua_pushnumber(L,120);
  lua_pushnumber(L,3000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:enderduck", {"default:dirt_with_grass"}, {"group:flora"}, 0, 10, 45, 900, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:enderduck");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"group:flora");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,10);
  lua_pushnumber(L,45);
  lua_pushnumber(L,900);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* --nssm:spawn_specific("nssm:flying_duck", {"air"}, {"group:flora"}, 10, 20, 60, 550, 1, 1, 31000)
   * nssm:spawn_specific("nssm:spiderduck", {"default:dirt_with_grass"}, {"group:flora"}, 0, 10, 45, 850, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:spiderduck");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"group:flora");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,10);
  lua_pushnumber(L,45);
  lua_pushnumber(L,850);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:swimming_duck", {"default:water_source"}, {"default:water_source"}, 0, 20, 60, 45000, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:swimming_duck");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:water_source");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:water_source");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,60);
  lua_pushnumber(L,45000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* -- MOUNTAINS
   * nssm:spawn_specific("nssm:echidna", {"default:dirt_with_grass"}, {"default:dirt_with_grass"}, 0, 20, 120, 45000, 1, 22, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:echidna");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,120);
  lua_pushnumber(L,45000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,22);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:manticore", {"default:dirt_with_grass"}, {"default:dirt_with_grass"}, 10, 20, 30, 15000, 1, 20, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:manticore");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,10);
  lua_pushnumber(L,20);
  lua_pushnumber(L,30);
  lua_pushnumber(L,15000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,20);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:werewolf", {"default:dirt_with_grass"}, {"default:dirt_with_grass"}, 0, 10, 30, 20000, 1, 20, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:werewolf");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,10);
  lua_pushnumber(L,30);
  lua_pushnumber(L,20000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,20);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* -- ICE
   * nssm:spawn_specific("nssm:icelamander", {"default:snowblock", "default:ice"}, {"default:snowblock", "default:ice"}, 0, 20, 120, 10000, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:icelamander");
  lua_createtable(L,2,0);
  lua_pushliteral(L,"default:snowblock");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:ice");
  lua_rawseti(L,-2,2);
  lua_createtable(L,2,0);
  lua_pushliteral(L,"default:snowblock");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:ice");
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,120);
  lua_pushnumber(L,10000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:icesnake", {"default:snowblock", "default:ice", "default:dirt_with_snow"}, {"default:snowblock", "default:ice", "default:dirt_with_snow"}, 0, 20, 30, 5000, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:icesnake");
  lua_createtable(L,3,0);
  lua_pushliteral(L,"default:snowblock");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:ice");
  lua_rawseti(L,-2,2);
  lua_pushliteral(L,"default:dirt_with_snow");
  lua_rawseti(L,-2,3);
  lua_createtable(L,3,0);
  lua_pushliteral(L,"default:snowblock");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:ice");
  lua_rawseti(L,-2,2);
  lua_pushliteral(L,"default:dirt_with_snow");
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,30);
  lua_pushnumber(L,5000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:white_werewolf", {"default:dirt_with_snow","default:snowblock"}, {"air"}, 0, 20, 60, 20000, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:white_werewolf");
  lua_createtable(L,2,0);
  lua_pushliteral(L,"default:dirt_with_snow");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:snowblock");
  lua_rawseti(L,-2,2);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,60);
  lua_pushnumber(L,20000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:snow_biter", {"default:snowblock", "default:ice", "default:dirt_with_snow"}, {"default:snowblock", "default:ice", "default:dirt_with_snow"}, 0, 20, 30, 5000, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:snow_biter");
  lua_createtable(L,3,0);
  lua_pushliteral(L,"default:snowblock");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:ice");
  lua_rawseti(L,-2,2);
  lua_pushliteral(L,"default:dirt_with_snow");
  lua_rawseti(L,-2,3);
  lua_createtable(L,3,0);
  lua_pushliteral(L,"default:snowblock");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:ice");
  lua_rawseti(L,-2,2);
  lua_pushliteral(L,"default:dirt_with_snow");
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,30);
  lua_pushnumber(L,5000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* -- FOREST
   * nssm:spawn_specific("nssm:larva", {"default:dirt_with_grass"}, {"default:tree"}, 0, 20, 40, 200, 1, -31000, 22) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:larva");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:tree");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,40);
  lua_pushnumber(L,200);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,22);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:masticone", {"default:dirt_with_grass"}, {"default:tree"}, 0, 20, 120, 4000, 2, -31000, 22) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:masticone");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:tree");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,120);
  lua_pushnumber(L,4000);
  lua_pushnumber(L,2);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,22);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* -- SKY
   * nssm:spawn_specific("nssm:moonheron", {"air"}, {"air"}, 0, 10, 100, 750000, 1, 10, 40) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:moonheron");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,10);
  lua_pushnumber(L,100);
  lua_pushnumber(L,750000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,10);
  lua_pushnumber(L,40);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:night_master", {"air"}, {"air"}, 0, 7, 120, 5200000, 2, 10, 40) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:night_master");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,7);
  lua_pushnumber(L,120);
  lua_pushnumber(L,5200000);
  lua_pushnumber(L,2);
  lua_pushnumber(L,10);
  lua_pushnumber(L,40);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:phoenix", {"air"}, {"air"}, 10, 20, 120, 5200000, 1, 10, 40) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:phoenix");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,10);
  lua_pushnumber(L,20);
  lua_pushnumber(L,120);
  lua_pushnumber(L,5200000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,10);
  lua_pushnumber(L,40);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:scrausics", {"air"}, {"air"}, 10, 20, 100, 750000, 1, 10, 40) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:scrausics");
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"air");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,10);
  lua_pushnumber(L,20);
  lua_pushnumber(L,100);
  lua_pushnumber(L,750000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,10);
  lua_pushnumber(L,40);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* -- PINE FOREST
   * nssm:spawn_specific("nssm:pumpboom_small", {"default:dirt_with_grass", "default:dirt_with_snow","default:snowblock"}, {"default:pine_tree"}, 0, 20, 30, 300, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:pumpboom_small");
  lua_createtable(L,3,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:dirt_with_snow");
  lua_rawseti(L,-2,2);
  lua_pushliteral(L,"default:snowblock");
  lua_rawseti(L,-2,3);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:pine_tree");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,30);
  lua_pushnumber(L,300);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:pumpboom_medium", {"default:dirt_with_grass", "default:dirt_with_snow","default:snowblock"}, {"default:pine_tree"}, 0, 20, 30, 400, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:pumpboom_medium");
  lua_createtable(L,3,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:dirt_with_snow");
  lua_rawseti(L,-2,2);
  lua_pushliteral(L,"default:snowblock");
  lua_rawseti(L,-2,3);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:pine_tree");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,30);
  lua_pushnumber(L,400);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:pumpboom_large", {"default:dirt_with_grass", "default:dirt_with_snow","default:snowblock"}, {"default:pine_tree"}, 0, 20, 30, 500, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:pumpboom_large");
  lua_createtable(L,3,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:dirt_with_snow");
  lua_rawseti(L,-2,2);
  lua_pushliteral(L,"default:snowblock");
  lua_rawseti(L,-2,3);
  lua_createtable(L,1,0);
  lua_pushliteral(L,"default:pine_tree");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,0);
  lua_pushnumber(L,20);
  lua_pushnumber(L,30);
  lua_pushnumber(L,500);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* nssm:spawn_specific("nssm:pumpking", {"default:dirt_with_grass", "default:dirt_with_snow","default:snowblock"}, {"default:pine_needles", "default:pine_tree"}, 0, 12, 120, 10000, 1, -31000, 31000) */
  lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
  lua_pushliteral(L,"spawn_specific");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushliteral(L,"nssm:pumpking");
  lua_createtable(L,3,0);
  lua_pushliteral(L,"default:dirt_with_grass");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:dirt_with_snow");
  lua_rawseti(L,-2,2);
  lua_pushliteral(L,"default:snowblock");
  lua_rawseti(L,-2,3);
  lua_createtable(L,2,0);
  lua_pushliteral(L,"default:pine_needles");
  lua_rawseti(L,-2,1);
  lua_pushliteral(L,"default:pine_tree");
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,0);
  lua_pushnumber(L,12);
  lua_pushnumber(L,120);
  lua_pushnumber(L,10000);
  lua_pushnumber(L,1);
  lua_pushnumber(L,-31000);
  lua_pushnumber(L,31000);
  lua_call(L,11,0);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* -- NSSB SPECIAL
   * if minetest.get_modpath("nssb") then */
  enum { lc1 = 0 };
  lua_getfield(L,LUA_ENVIRONINDEX,"minetest");
  lua_pushliteral(L,"get_modpath");
  lua_gettable(L,-2);
  lua_remove(L,-2);
  lua_pushliteral(L,"nssb");
  lua_call(L,1,1);
  const int lc2 = lua_toboolean(L,-1);
  lua_pop(L,1);
  if (lc2) {
    
    /* nssm:spawn_specific("nssm:xgaloctopus", {"default:water_source"}, {"nssb:marine_brick"}, 0, 20, 20, 800, 1, -31000, 0) */
    lua_getfield(L,LUA_ENVIRONINDEX,"nssm");
    lua_pushliteral(L,"spawn_specific");
    lua_gettable(L,-2);
    lua_insert(L,-2);
    lua_pushliteral(L,"nssm:xgaloctopus");
    lua_createtable(L,1,0);
    lua_pushliteral(L,"default:water_source");
    lua_rawseti(L,-2,1);
    lua_createtable(L,1,0);
    lua_pushliteral(L,"nssb:marine_brick");
    lua_rawseti(L,-2,1);
    lua_pushnumber(L,0);
    lua_pushnumber(L,20);
    lua_pushnumber(L,20);
    lua_pushnumber(L,800);
    lua_pushnumber(L,1);
    lua_pushnumber(L,-31000);
    lua_pushnumber(L,0);
    lua_call(L,11,0);
    assert(lua_gettop(L) - lc_nextra == 0);
  }
  lua_settop(L,(lc1 + lc_nextra));
  assert(lua_gettop(L) - lc_nextra == 0);
  return 0;
}


/* from lua.c */
static int traceback (lua_State *L) {
  if (!lua_isstring(L, 1))  /* 'message' not a string? */
    return 1;  /* keep it intact */
  lua_getfield(L, LUA_GLOBALSINDEX, "debug");
  if (!lua_istable(L, -1)) {
    lua_pop(L, 1);
    return 1;
  }
  lua_getfield(L, -1, "traceback");
  if (!lua_isfunction(L, -1)) {
    lua_pop(L, 2);
    return 1;
  }
  lua_pushvalue(L, 1);  /* pass error message */
  lua_pushinteger(L, 2);  /* skip this function and traceback */
  lua_call(L, 2, 1);  /* call debug.traceback */
  return 1;
}


static void lc_l_message (const char *pname, const char *msg) {
  if (pname) fprintf(stderr, "%s: ", pname);
  fprintf(stderr, "%s\n", msg);
  fflush(stderr);
}

static int lc_report (lua_State *L, int status) {
  if (status && !lua_isnil(L, -1)) {
    const char *msg = lua_tostring(L, -1);
    if (msg == NULL) msg = "(error object is not a string)";
    /*FIX-IMROVE:progname*/
    lc_l_message("lua", msg);
    lua_pop(L, 1);
  }
  return status;
}

static int lc_docall (lua_State *L, int narg, int clear) {
  int status;
  int base = lua_gettop(L) - narg;  /* function index */
  lua_pushcfunction(L, traceback);  /* push traceback function */
  lua_insert(L, base);  /* put it under chunk and args */
  /*FIX? signal(SIGINT, laction); */
  status = lua_pcall(L, narg, (clear ? 0 : LUA_MULTRET), base);
  /*FIX? signal(SIGINT, SIG_DFL); */
  lua_remove(L, base);  /* remove traceback function */
  /* force a complete garbage collection in case of errors */
  if (status != 0) lua_gc(L, LUA_GCCOLLECT, 0);
  return status;
}

static int lc_dofile (lua_State *L, const char *name) {
  int status = luaL_loadfile(L, name) || lc_docall(L, 0, 1);
  return lc_report(L, status);
}

static int lc_dostring (lua_State *L, const char *s, const char *name) {
  int status = luaL_loadbuffer(L, s, strlen(s), name) || lc_docall(L, 0, 1);
  return lc_report(L, status);
}

static int lc_handle_luainit (lua_State *L) {
  const char *init = getenv(LUA_INIT);
  if (init == NULL) return 0;  /* status OK */
  else if (init[0] == '@')
    return lc_dofile(L, init+1);
  else
    return lc_dostring(L, init, "=" LUA_INIT);
}


typedef struct {
  int c;
  const char ** v;
} lc_args_t;


/* create global arg table */
static void lc_createarg(lua_State * L, const lc_args_t * const args) {
  int i;
  lua_newtable(L);
  for (i=0; i < args->c; i++) {
    lua_pushstring(L, args->v[i]);
    lua_rawseti(L, -2, i);
  }
  lua_setglobal(L, "arg");
}


int lc_pmain_mod_nssm_spawn(lua_State * L) {
  luaL_openlibs(L);

  lua_pushcfunction(L, traceback);

  const int status1 = lc_handle_luainit(L);
  if (status1 != 0) return 0;

  /* note: IMPROVE: closure not always needed here */
  lua_newtable(L); /* closure table */
  lua_pushcclosure(L, lcf_main, 1);

  int status2 = lua_pcall(L, 0, 0, -2);
  if (status2 != 0) {
    const char * msg = lua_tostring(L,-1);
    if (msg == NULL) msg = "(error object is not a string)";
    fputs(msg, stderr);
  }
  return 0;
}



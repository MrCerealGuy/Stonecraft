/* WARNING: This file was automatically generated by lua2c. */

#ifdef __cplusplus
extern "C" {
#endif
#include <lua.h>
#include <lauxlib.h>
#include <lualib.h>
#ifdef __cplusplus
}
#endif
#include <stdio.h>
#include <stdlib.h>


#include <string.h>


#include <assert.h>

/* name: ADD_RCC
 * function( data) */
static int lcf1_ADD_RCC (lua_State * L) {
  enum { lc_nformalargs = 1 };
  lua_settop(L,1);
  
  /* if( data and #data>3 and ( minetest.registered_nodes[ data[1] ] or minetest.registered_items[ data[1] ]) ) then */
  enum { lc1 = 1 };
  lua_pushvalue(L,1);
  if (lua_toboolean(L,-1)) {
    lua_pop(L,1);
    lua_pushnumber(L,3);
    const double lc2 = lua_objlen(L,1);
    lua_pushnumber(L,lc2);
    const int lc3 = lua_lessthan(L,-2,-1);
    lua_pop(L,2);
    lua_pushboolean(L,lc3);
  }
  if (lua_toboolean(L,-1)) {
    lua_pop(L,1);
    lua_getfield(L,LUA_ENVIRONINDEX,"minetest");
    lua_pushliteral(L,"registered_nodes");
    lua_gettable(L,-2);
    lua_remove(L,-2);
    lua_pushnumber(L,1);
    lua_gettable(L,1);
    lua_gettable(L,-2);
    lua_remove(L,-2);
    if (!(lua_toboolean(L,-1))) {
      lua_pop(L,1);
      lua_getfield(L,LUA_ENVIRONINDEX,"minetest");
      lua_pushliteral(L,"registered_items");
      lua_gettable(L,-2);
      lua_remove(L,-2);
      lua_pushnumber(L,1);
      lua_gettable(L,1);
      lua_gettable(L,-2);
      lua_remove(L,-2);
    }
  }
  const int lc4 = lua_toboolean(L,-1);
  lua_pop(L,1);
  if (lc4) {
    
    /* data.chest_default = 1 */
    lua_pushnumber(L,1);
    lua_pushliteral(L,"chest_default");
    lua_insert(L,-2);
    lua_settable(L,1);
    assert(lua_gettop(L) == 1);
    
    /* table.insert( mg_villages.random_chest_content, data ) */
    lua_getfield(L,LUA_ENVIRONINDEX,"table");
    lua_pushliteral(L,"insert");
    lua_gettable(L,-2);
    lua_remove(L,-2);
    lua_getfield(L,LUA_ENVIRONINDEX,"mg_villages");
    lua_pushliteral(L,"random_chest_content");
    lua_gettable(L,-2);
    lua_remove(L,-2);
    lua_pushvalue(L,1);
    lua_call(L,2,0);
    assert(lua_gettop(L) == 1);
  }
  lua_settop(L,lc1);
  assert(lua_gettop(L) == 1);
  return 0;
}


/* name: mg_villages.fill_chest_random
 * function( pos, pr, building_nr, building_typ) */
static int lcf1_mg_villages_fill_chest_random (lua_State * L) {
  lua_checkstack(L,21);
  enum { lc_nformalargs = 4 };
  lua_settop(L,4);
  
  /* local building_data = mg_villages.BUILDINGS[ building_nr.btype ] */
  lua_getfield(L,LUA_ENVIRONINDEX,"mg_villages");
  lua_pushliteral(L,"BUILDINGS");
  lua_gettable(L,-2);
  lua_remove(L,-2);
  lua_pushliteral(L,"btype");
  lua_gettable(L,3);
  lua_gettable(L,-2);
  lua_remove(L,-2);
  assert(lua_gettop(L) == 5);
  
  /* local meta = minetest.env:get_meta( pos ) */
  lua_getfield(L,LUA_ENVIRONINDEX,"minetest");
  lua_pushliteral(L,"env");
  lua_gettable(L,-2);
  lua_remove(L,-2);
  lua_pushliteral(L,"get_meta");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushvalue(L,1);
  lua_call(L,2,1);
  assert(lua_gettop(L) == 6);
  
  /* local inv  = meta:get_inventory() */
  lua_pushvalue(L,6);
  lua_pushliteral(L,"get_inventory");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_call(L,1,1);
  assert(lua_gettop(L) == 7);
  
  /* -- bookshelves use "books" instead of "main" for their inventory
   * local inv_source = 'main' */
  lua_pushliteral(L,"main");
  assert(lua_gettop(L) == 8);
  
  /* -- which kind of content might be expected for this particular chest?
   * local typ = minetest.get_name_from_content_id( pos.typ ) */
  lua_getfield(L,LUA_ENVIRONINDEX,"minetest");
  lua_pushliteral(L,"get_name_from_content_id");
  lua_gettable(L,-2);
  lua_remove(L,-2);
  lua_pushliteral(L,"typ");
  lua_gettable(L,1);
  lua_call(L,1,1);
  assert(lua_gettop(L) == 9);
  
  /* if( pos.typ_name ) then */
  enum { lc14 = 9 };
  lua_pushliteral(L,"typ_name");
  lua_gettable(L,1);
  const int lc15 = lua_toboolean(L,-1);
  lua_pop(L,1);
  if (lc15) {
    
    /* typ = pos.typ_name */
    lua_pushliteral(L,"typ_name");
    lua_gettable(L,1);
    lua_replace(L,9);
    assert(lua_gettop(L) == 9);
  }
  lua_settop(L,lc14);
  assert(lua_gettop(L) == 9);
  
  /* if(     typ == 'default:bookshelf') then */
  enum { lc16 = 9 };
  lua_pushliteral(L,"default:bookshelf");
  const int lc17 = lua_equal(L,9,-1);
  lua_pop(L,1);
  lua_pushboolean(L,lc17);
  const int lc18 = lua_toboolean(L,-1);
  lua_pop(L,1);
  if (lc18) {
    
    /* typ = 'chest_bookshelf' */
    lua_pushliteral(L,"chest_bookshelf");
    lua_replace(L,9);
    assert(lua_gettop(L) == 9);
    
    /* inv_source = 'books' */
    lua_pushliteral(L,"books");
    lua_replace(L,8);
    assert(lua_gettop(L) == 9);
  }
  else {
    
    /* elseif( typ == 'default:chest') then */
    enum { lc19 = 9 };
    lua_pushliteral(L,"default:chest");
    const int lc20 = lua_equal(L,9,-1);
    lua_pop(L,1);
    lua_pushboolean(L,lc20);
    const int lc21 = lua_toboolean(L,-1);
    lua_pop(L,1);
    if (lc21) {
      
      /* typ = 'chest_default' */
      lua_pushliteral(L,"chest_default");
      lua_replace(L,9);
      assert(lua_gettop(L) == 9);
    }
    else {
      
      /* elseif( not( typ ) or (typ ~= 'cottages:shelf' and typ ~= 'cottages:chest_work' and typ ~= 'cottages:chest_storage' and typ ~= 'cottages:chest_private')) then */
      enum { lc22 = 9 };
      lua_pushboolean(L,!(lua_toboolean(L,9)));
      if (!(lua_toboolean(L,-1))) {
        lua_pop(L,1);
        lua_pushliteral(L,"cottages:shelf");
        const int lc23 = lua_equal(L,9,-1);
        lua_pop(L,1);
        lua_pushboolean(L,lc23);
        lua_pushboolean(L,!(lua_toboolean(L,-1)));
        lua_remove(L,-2);
        if (lua_toboolean(L,-1)) {
          lua_pop(L,1);
          lua_pushliteral(L,"cottages:chest_work");
          const int lc24 = lua_equal(L,9,-1);
          lua_pop(L,1);
          lua_pushboolean(L,lc24);
          lua_pushboolean(L,!(lua_toboolean(L,-1)));
          lua_remove(L,-2);
        }
        if (lua_toboolean(L,-1)) {
          lua_pop(L,1);
          lua_pushliteral(L,"cottages:chest_storage");
          const int lc25 = lua_equal(L,9,-1);
          lua_pop(L,1);
          lua_pushboolean(L,lc25);
          lua_pushboolean(L,!(lua_toboolean(L,-1)));
          lua_remove(L,-2);
        }
        if (lua_toboolean(L,-1)) {
          lua_pop(L,1);
          lua_pushliteral(L,"cottages:chest_private");
          const int lc26 = lua_equal(L,9,-1);
          lua_pop(L,1);
          lua_pushboolean(L,lc26);
          lua_pushboolean(L,!(lua_toboolean(L,-1)));
          lua_remove(L,-2);
        }
      }
      const int lc27 = lua_toboolean(L,-1);
      lua_pop(L,1);
      if (lc27) {
        
        /* typ = building_data.typ */
        lua_pushliteral(L,"typ");
        lua_gettable(L,5);
        lua_replace(L,9);
        assert(lua_gettop(L) == 9);
      }
      else {
        
        /* else
         * typ = string.sub( typ, 10 ) */
        lua_getfield(L,LUA_ENVIRONINDEX,"string");
        lua_pushliteral(L,"sub");
        lua_gettable(L,-2);
        lua_remove(L,-2);
        lua_pushvalue(L,9);
        lua_pushnumber(L,10);
        lua_call(L,2,1);
        lua_replace(L,9);
        assert(lua_gettop(L) == 9);
      }
      lua_settop(L,lc22);
    }
    lua_settop(L,lc19);
  }
  lua_settop(L,lc16);
  assert(lua_gettop(L) == 9);
  
  /* local typ2 = nil */
  lua_pushnil(L);
  assert(lua_gettop(L) == 10);
  
  /* if( typ == 'chest_work' and building_data.typ ) then */
  enum { lc28 = 10 };
  lua_pushvalue(L,9);
  lua_pushliteral(L,"chest_work");
  const int lc29 = lua_equal(L,-2,-1);
  lua_pop(L,2);
  lua_pushboolean(L,lc29);
  if (lua_toboolean(L,-1)) {
    lua_pop(L,1);
    lua_pushliteral(L,"typ");
    lua_gettable(L,5);
  }
  const int lc30 = lua_toboolean(L,-1);
  lua_pop(L,1);
  if (lc30) {
    
    /* typ2 = building_data.typ */
    lua_pushliteral(L,"typ");
    lua_gettable(L,5);
    lua_replace(L,10);
    assert(lua_gettop(L) == 10);
  }
  lua_settop(L,lc28);
  assert(lua_gettop(L) == 10);
  
  /* if( not( typ ) or typ=='' ) then */
  enum { lc31 = 10 };
  lua_pushboolean(L,!(lua_toboolean(L,9)));
  if (!(lua_toboolean(L,-1))) {
    lua_pop(L,1);
    lua_pushvalue(L,9);
    lua_pushliteral(L,"");
    const int lc32 = lua_equal(L,-2,-1);
    lua_pop(L,2);
    lua_pushboolean(L,lc32);
  }
  const int lc33 = lua_toboolean(L,-1);
  lua_pop(L,1);
  if (lc33) {
    
    /* return; */
    return 0;
    assert(lua_gettop(L) == 10);
  }
  lua_settop(L,lc31);
  assert(lua_gettop(L) == 10);
  
  /* local inv_size = inv:get_size( inv_source ) */
  lua_pushvalue(L,7);
  lua_pushliteral(L,"get_size");
  lua_gettable(L,-2);
  lua_insert(L,-2);
  lua_pushvalue(L,8);
  lua_call(L,2,1);
  assert(lua_gettop(L) == 11);
  
  /* mg_villages.fill_one_chest_random( pos, pr, typ, typ2, inv, inv_size, inv_source, building_nr, building_typ, building_data) */
  lua_getfield(L,LUA_ENVIRONINDEX,"mg_villages");
  lua_pushliteral(L,"fill_one_chest_random");
  lua_gettable(L,-2);
  lua_remove(L,-2);
  lua_pushvalue(L,1);
  lua_pushvalue(L,2);
  lua_pushvalue(L,9);
  lua_pushvalue(L,10);
  lua_pushvalue(L,7);
  lua_pushvalue(L,11);
  lua_pushvalue(L,8);
  lua_pushvalue(L,3);
  lua_pushvalue(L,4);
  lua_pushvalue(L,5);
  lua_call(L,10,0);
  assert(lua_gettop(L) == 11);
  return 0;
}


/* __add metamethod handler.
 * warning: assumes indices in range LUA_REGISTRYINDEX < x < 0 are relative. */
static void lc_add(lua_State * L, int idxa, int idxb) {
  if (lua_isnumber(L,idxa) && lua_isnumber(L,idxb)) {
    lua_pushnumber(L,lua_tonumber(L,idxa) + lua_tonumber(L,idxb));
  }
  else {
    if (luaL_getmetafield(L,idxa,"__add")||luaL_getmetafield(L,idxb,"__add")) {
      lua_pushvalue(L,idxa < 0 && idxa > LUA_REGISTRYINDEX ? idxa-1 : idxa);
      lua_pushvalue(L,idxb < 0 && idxb > LUA_REGISTRYINDEX ? idxb-2 : idxb);
      lua_call(L,2,1);
    }
    else {
      luaL_error(L, "attempt to perform arithmetic");
    }
  }
}


/* name: mg_villages.fill_one_chest_random
 * function( pos, pr, typ, typ2, inv, inv_size, inv_source, building_nr, building_typ, building_data) */
static int lcf1_mg_villages_fill_one_chest_random (lua_State * L) {
  lua_checkstack(L,27);
  enum { lc_nformalargs = 10 };
  lua_settop(L,10);
  
  /* local count */
  lua_settop(L,(lua_gettop(L) + 1));
  assert(lua_gettop(L) == 11);
  
  /* for i,v in ipairs( mg_villages.random_chest_content ) do
   * 
   * 		-- repeat this many times
   * internal: local f, s, var = explist */
  enum { lc34 = 11 };
  lua_getfield(L,LUA_ENVIRONINDEX,"ipairs");
  lua_getfield(L,LUA_ENVIRONINDEX,"mg_villages");
  lua_pushliteral(L,"random_chest_content");
  lua_gettable(L,-2);
  lua_remove(L,-2);
  lua_call(L,1,3);
  while (1) {
    
    /* internal: local var_1, ..., var_n = f(s, var)
     *           if var_1 == nil then break end
     *           var = var_1 */
    lua_pushvalue(L,-3);
    lua_pushvalue(L,-3);
    lua_pushvalue(L,-3);
    lua_call(L,2,2);
    if (lua_isnil(L,-2)) {
      break;
    }
    lua_pushvalue(L,-2);
    lua_replace(L,-4);
    
    /* internal: local i with idx 15
     * internal: local v with idx 16 */
    
    
    /* -- repeat this many times
     * for count=1, v[ 4 ] do
     * 
     * 			-- to avoid too many things inside a chest, lower probability */
    lua_pushnumber(L,1);
    lua_pushnumber(L,4);
    lua_gettable(L,16);
    if (!((lua_isnumber(L,-2) && lua_isnumber(L,-1)))) {
      luaL_error(L,"'for' limit must be a number");
    }
    double lc35_var = lua_tonumber(L,-2);
    const double lc36_limit = lua_tonumber(L,-1);
    const double lc37_step = 1;
    lua_pop(L,2);
    enum { lc38 = 16 };
    while ((((lc37_step > 0) && (lc35_var <= lc36_limit)) || ((lc37_step <= 0) && (lc35_var >= lc36_limit)))) {
      
      /* internal: local count at index 17 */
      lua_pushnumber(L,lc35_var);
      
      /* -- to avoid too many things inside a chest, lower probability
       * if(     count<30 -- make sure it does not get too much and there is still room for a new stack
       * 			 and (v[ typ ] or (typ2 and v[ typ2 ]))
       * 			 and inv_size and inv_size > 0 and v[ 2 ] > pr:next( 1, 200 )) then */
      enum { lc39 = 17 };
      lua_pushnumber(L,30);
      const int lc40 = lua_lessthan(L,17,-1);
      lua_pop(L,1);
      lua_pushboolean(L,lc40);
      if (lua_toboolean(L,-1)) {
        lua_pop(L,1);
        lua_pushvalue(L,3);
        lua_gettable(L,16);
        if (!(lua_toboolean(L,-1))) {
          lua_pop(L,1);
          lua_pushvalue(L,4);
          if (lua_toboolean(L,-1)) {
            lua_pop(L,1);
            lua_pushvalue(L,4);
            lua_gettable(L,16);
          }
        }
      }
      if (lua_toboolean(L,-1)) {
        lua_pop(L,1);
        lua_pushvalue(L,6);
      }
      if (lua_toboolean(L,-1)) {
        lua_pop(L,1);
        lua_pushnumber(L,0);
        const int lc41 = lua_lessthan(L,-1,6);
        lua_pop(L,1);
        lua_pushboolean(L,lc41);
      }
      if (lua_toboolean(L,-1)) {
        lua_pop(L,1);
        lua_pushvalue(L,2);
        lua_pushliteral(L,"next");
        lua_gettable(L,-2);
        lua_insert(L,-2);
        lua_pushnumber(L,1);
        lua_pushnumber(L,200);
        lua_call(L,3,1);
        lua_pushnumber(L,2);
        lua_gettable(L,16);
        const int lc42 = lua_lessthan(L,-2,-1);
        lua_pop(L,2);
        lua_pushboolean(L,lc42);
      }
      const int lc43 = lua_toboolean(L,-1);
      lua_pop(L,1);
      if (lc43) {
        
        /* --inv:add_item('main', v[ 1 ].." "..tostring( math.random( 1, tonumber(v[ 3 ]) )));
         * -- add itemstack at a random position in the chests inventory 
         * inv:set_stack( inv_source, pr:next( 1, inv_size), v[ 1 ].." "..tostring( pr:next( 1, tonumber(v[ 3 ]) )) ) */
        lua_pushvalue(L,5);
        lua_pushliteral(L,"set_stack");
        lua_gettable(L,-2);
        lua_insert(L,-2);
        lua_pushvalue(L,7);
        lua_pushvalue(L,2);
        lua_pushliteral(L,"next");
        lua_gettable(L,-2);
        lua_insert(L,-2);
        lua_pushnumber(L,1);
        lua_pushvalue(L,6);
        lua_call(L,3,1);
        lua_pushnumber(L,1);
        lua_gettable(L,16);
        lua_pushliteral(L," ");
        lua_getfield(L,LUA_ENVIRONINDEX,"tostring");
        const int lc44 = lua_gettop(L);
        lua_pushvalue(L,2);
        const int lc45 = lua_gettop(L);
        lua_pushliteral(L,"next");
        lua_gettable(L,-2);
        lua_insert(L,-2);
        lua_pushnumber(L,1);
        lua_getfield(L,LUA_ENVIRONINDEX,"tonumber");
        lua_pushnumber(L,3);
        lua_gettable(L,16);
        lua_call(L,1,LUA_MULTRET);
        lua_call(L,(lua_gettop(L) - lc45),LUA_MULTRET);
        lua_call(L,(lua_gettop(L) - lc44),1);
        lua_concat(L,2);
        lua_concat(L,2);
        lua_call(L,4,0);
        assert(lua_gettop(L) == 17);
        
        /* count = count+1 */
        lua_pushnumber(L,1);
        lc_add(L,17,-1);
        lua_remove(L,-2);
        lua_replace(L,17);
        assert(lua_gettop(L) == 17);
      }
      lua_settop(L,lc39);
      assert(lua_gettop(L) == 17);
      
      /* internal: stack cleanup on scope exit */
      lua_pop(L,1);
      lc35_var += lc37_step;
    }
    lua_settop(L,lc38);
    assert(lua_gettop(L) == 16);
    
    /* internal: stack cleanup on scope exit */
    lua_pop(L,2);
  }
  lua_settop(L,lc34);
  assert(lua_gettop(L) == 11);
  return 0;
}


/* name: (main)
 * function(...) */
static int lcf_main (lua_State * L) {
  enum { lc_nformalargs = 0 };
  const int lc_nactualargs = lua_gettop(L);
  const int lc_nextra = (lc_nactualargs - lc_nformalargs);
  
  /* -- TODO: refill chest after some time?
   * -- TODO: alert NPC that something was taken
   * mg_villages.random_chest_content = {} */
  lua_newtable(L);
  lua_getfield(L,LUA_ENVIRONINDEX,"mg_villages");
  lua_insert(L,-2);
  lua_pushliteral(L,"random_chest_content");
  lua_insert(L,-2);
  lua_settable(L,-3);
  lua_pop(L,1);
  assert(lua_gettop(L) - lc_nextra == 0);
  
  /* -- add random chest content
   * local ADD_RCC = function( data )
   * 	if( data and #data>3 and ( minetest.registered_nodes[ data[1] ] or minetest.registered_items[ data[1] ]) ) then
   * 		data.chest_default = 1;
   * 		table.insert( mg_villages.random_chest_content, data );
   * 	end
   * end */
  lua_pushcfunction(L,lcf1_ADD_RCC);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* -- things that can be found in private, not locked chests belonging to npc
   * -- contains tables of the following structure: { node_name, probability (in percent, 100=always, 0=never), max_amount, repeat (for more than one stack) }
   * mg_villages.random_chest_content = {} */
  lua_newtable(L);
  lua_getfield(L,LUA_ENVIRONINDEX,"mg_villages");
  lua_insert(L,-2);
  lua_pushliteral(L,"random_chest_content");
  lua_insert(L,-2);
  lua_settable(L,-3);
  lua_pop(L,1);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:pick_stone",             10,  1, 3, farm_tiny=1, farm_full=1, shed=1, lumberjack=1, hut=1, chest_work=1, lumberjack=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,7);
  lua_pushliteral(L,"default:pick_stone");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,10);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"farm_tiny");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"farm_full");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"shed");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"lumberjack");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"hut");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"lumberjack");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:pick_steel",              5,  1, 2, forge=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"default:pick_steel");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,5);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:pick_mese",               2,  1, 2, forge=1, lumberjack=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"default:pick_mese");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"lumberjack");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:shovel_stone",            5,  1, 3, farm_tiny=1, farm_full=1, shed=1, lumberjack=1, hut=1, chest_work=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,6);
  lua_pushliteral(L,"default:shovel_stone");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,5);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"farm_tiny");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"farm_full");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"shed");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"lumberjack");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"hut");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:shovel_steel",            5,  1, 2, forge=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"default:shovel_steel");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,5);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:axe_stone",               5,  1, 3, farm_tiny=1, farm_full=1, chest_work=1, lumberjack=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,4);
  lua_pushliteral(L,"default:axe_stone");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,5);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"farm_tiny");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"farm_full");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"lumberjack");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:axe_steel",               5,  1, 2, forge=1, lumberjack=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"default:axe_steel");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,5);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"lumberjack");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:sword_wood",              1,  1, 3, guard=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"default:sword_wood");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"guard");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:sword_stone",             1,  1, 3, guard=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"default:sword_stone");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"guard");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:sword_steel",             1,  1, 3, forge=1, guard=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"default:sword_steel");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"guard");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:stick",                  20, 40, 2, church=1, library=1, chest_private=1, shelf=5, shed=1, lumberjack=1, hut=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,7);
  lua_pushliteral(L,"default:stick");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,20);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,40);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"shelf");
  lua_pushnumber(L,5);
  lua_rawset(L,-3);
  lua_pushliteral(L,"shed");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"lumberjack");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"hut");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:torch",                  50, 10, 4, church=1, library=1, chest_private=1, shelf=1, shed=1, lumberjack=1, hut=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,7);
  lua_pushliteral(L,"default:torch");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,10);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,4);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"shelf");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"shed");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"lumberjack");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"hut");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:book",                   60,  1, 1, church=1, library=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"default:book");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,60);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:book",                   90,  1,12, chest_bookshelf=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"default:book");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,90);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,12);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"chest_bookshelf");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:paper",                  60,  6, 4, church=1, library=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"default:paper");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,60);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,6);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,4);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:apple",                  50, 10, 2, chest_storage=4, chest_private=1, shelf=5}) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"default:apple");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,10);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,4);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"shelf");
  lua_pushnumber(L,5);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:ladder",                 20,  1, 2, church=1, library=1, shed=1, lumberjack=1, hut=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,5);
  lua_pushliteral(L,"default:ladder");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,20);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"shed");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"lumberjack");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"hut");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:coal_lump",              80, 30, 1, forge=1, shed=1, lumberjack=1, hut=1}) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,4);
  lua_pushliteral(L,"default:coal_lump");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,30);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"shed");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"lumberjack");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"hut");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:steel_ingot",            30,  4, 2, forge=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"default:steel_ingot");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,30);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,4);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"default:mese_crystal_fragment",  10,  3, 1, forge=1, chest_storage=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"default:mese_crystal_fragment");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,10);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"bucket:bucket_empty",            10,  3, 2, chest_work=1, forge=1, shed=1, hut=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,4);
  lua_pushliteral(L,"bucket:bucket_empty");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,10);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"shed");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"hut");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"bucket:bucket_water",             5,  3, 2, chest_work=1, forge=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"bucket:bucket_water");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,5);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"bucket:bucket_lava",              3,  3, 2, forge=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bucket:bucket_lava");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"vessels:glass_bottle",           10, 10, 2, church=1, library=1, shelf=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"vessels:glass_bottle");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,10);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,10);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"shelf");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"vessels:drinking_glass",         20,  2, 1, church=1, library=1, shelf=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"vessels:drinking_glass");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,20);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"shelf");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"vessels:steel_bottle",           10,  1, 1, church=1, library=1, shelf=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"vessels:steel_bottle");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,10);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"shelf");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"wool:white",                     60,  8, 2, church=1, library=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"wool:white");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,60);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,8);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* -- that someone will hide valuable ingots in chests that are not locked is fairly unrealistic; thus, those items are rare
   * ADD_RCC({"moreores:gold_ingot",             1,  2, 1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,0);
  lua_pushliteral(L,"moreores:gold_ingot");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"moreores:silver_ingot",           1,  2, 1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,0);
  lua_pushliteral(L,"moreores:silver_ingot");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"moreores:copper_ingot",          30, 10, 1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,0);
  lua_pushliteral(L,"moreores:copper_ingot");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,30);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,10);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"moreores:tin_ingot",              1,  5, 1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,0);
  lua_pushliteral(L,"moreores:tin_ingot");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,5);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"moreores:bronze_ingot",           1,  1, 1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,0);
  lua_pushliteral(L,"moreores:bronze_ingot");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"moreores:mithril_ingot",          1,  1, 1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,0);
  lua_pushliteral(L,"moreores:mithril_ingot");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* -- candles are a very likely content of chests
   * ADD_RCC({"candles:candle",                 80, 12, 2, church=1, library=1, chest_private=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"candles:candle");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,12);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"candles:candelabra_steel",        1,  1, 1, church=1, library=1, chest_private=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"candles:candelabra_steel");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"candles:candelabra_copper",       1,  1, 1, church=1, library=1, chest_private=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"candles:candelabra_copper");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"candles:honey",                  50,  2, 1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,0);
  lua_pushliteral(L,"candles:honey");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* -- our NPC have to spend their free time somehow...also adds food variety
   * ADD_RCC({"fishing:pole",                   60,  1, 1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,0);
  lua_pushliteral(L,"fishing:pole");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,60);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* -- ropes are always useful
   * if( minetest.get_modpath("ropes") ~= nil ) then */
  enum { lc5 = 1 };
  lua_getfield(L,LUA_ENVIRONINDEX,"minetest");
  lua_pushliteral(L,"get_modpath");
  lua_gettable(L,-2);
  lua_remove(L,-2);
  lua_pushliteral(L,"ropes");
  lua_call(L,1,1);
  lua_pushnil(L);
  const int lc6 = lua_equal(L,-2,-1);
  lua_pop(L,2);
  lua_pushboolean(L,lc6);
  lua_pushboolean(L,!(lua_toboolean(L,-1)));
  lua_remove(L,-2);
  const int lc7 = lua_toboolean(L,-1);
  lua_pop(L,1);
  if (lc7) {
    
    /* ADD_RCC({"ropes:rope",                     60,  5, 2, chest_work=1, shelf=1, chest_storage=1 }) */
    lua_pushvalue(L,(1 + lc_nextra));
    lua_createtable(L,4,3);
    lua_pushliteral(L,"ropes:rope");
    lua_rawseti(L,-2,1);
    lua_pushnumber(L,60);
    lua_rawseti(L,-2,2);
    lua_pushnumber(L,5);
    lua_rawseti(L,-2,3);
    lua_pushnumber(L,2);
    lua_rawseti(L,-2,4);
    lua_pushliteral(L,"chest_work");
    lua_pushnumber(L,1);
    lua_rawset(L,-3);
    lua_pushliteral(L,"shelf");
    lua_pushnumber(L,1);
    lua_rawset(L,-3);
    lua_pushliteral(L,"chest_storage");
    lua_pushnumber(L,1);
    lua_rawset(L,-3);
    lua_call(L,1,0);
    assert(lua_gettop(L) - lc_nextra == 1);
  }
  else {
    
    /* elseif( minetest.get_modpath("farming") ~= nil ) then */
    enum { lc8 = 1 };
    lua_getfield(L,LUA_ENVIRONINDEX,"minetest");
    lua_pushliteral(L,"get_modpath");
    lua_gettable(L,-2);
    lua_remove(L,-2);
    lua_pushliteral(L,"farming");
    lua_call(L,1,1);
    lua_pushnil(L);
    const int lc9 = lua_equal(L,-2,-1);
    lua_pop(L,2);
    lua_pushboolean(L,lc9);
    lua_pushboolean(L,!(lua_toboolean(L,-1)));
    lua_remove(L,-2);
    const int lc10 = lua_toboolean(L,-1);
    lua_pop(L,1);
    if (lc10) {
      
      /* ADD_RCC({"farming:string",                 60,  5, 2, church=1, library=1, chest_work=1, shelf=1, chest_storage=1 }) */
      lua_pushvalue(L,(1 + lc_nextra));
      lua_createtable(L,4,5);
      lua_pushliteral(L,"farming:string");
      lua_rawseti(L,-2,1);
      lua_pushnumber(L,60);
      lua_rawseti(L,-2,2);
      lua_pushnumber(L,5);
      lua_rawseti(L,-2,3);
      lua_pushnumber(L,2);
      lua_rawseti(L,-2,4);
      lua_pushliteral(L,"church");
      lua_pushnumber(L,1);
      lua_rawset(L,-3);
      lua_pushliteral(L,"library");
      lua_pushnumber(L,1);
      lua_rawset(L,-3);
      lua_pushliteral(L,"chest_work");
      lua_pushnumber(L,1);
      lua_rawset(L,-3);
      lua_pushliteral(L,"shelf");
      lua_pushnumber(L,1);
      lua_rawset(L,-3);
      lua_pushliteral(L,"chest_storage");
      lua_pushnumber(L,1);
      lua_rawset(L,-3);
      lua_call(L,1,0);
      assert(lua_gettop(L) - lc_nextra == 1);
    }
    else {
      
      /* elseif( minetest.get_modpath("moreblocks") ~= nil ) then */
      enum { lc11 = 1 };
      lua_getfield(L,LUA_ENVIRONINDEX,"minetest");
      lua_pushliteral(L,"get_modpath");
      lua_gettable(L,-2);
      lua_remove(L,-2);
      lua_pushliteral(L,"moreblocks");
      lua_call(L,1,1);
      lua_pushnil(L);
      const int lc12 = lua_equal(L,-2,-1);
      lua_pop(L,2);
      lua_pushboolean(L,lc12);
      lua_pushboolean(L,!(lua_toboolean(L,-1)));
      lua_remove(L,-2);
      const int lc13 = lua_toboolean(L,-1);
      lua_pop(L,1);
      if (lc13) {
        
        /* ADD_RCC({"moreblocks:rope",                60,  5, 2, chest_work=1, shelf=1, chest_storage=1 }) */
        lua_pushvalue(L,(1 + lc_nextra));
        lua_createtable(L,4,3);
        lua_pushliteral(L,"moreblocks:rope");
        lua_rawseti(L,-2,1);
        lua_pushnumber(L,60);
        lua_rawseti(L,-2,2);
        lua_pushnumber(L,5);
        lua_rawseti(L,-2,3);
        lua_pushnumber(L,2);
        lua_rawseti(L,-2,4);
        lua_pushliteral(L,"chest_work");
        lua_pushnumber(L,1);
        lua_rawset(L,-3);
        lua_pushliteral(L,"shelf");
        lua_pushnumber(L,1);
        lua_rawset(L,-3);
        lua_pushliteral(L,"chest_storage");
        lua_pushnumber(L,1);
        lua_rawset(L,-3);
        lua_call(L,1,0);
        assert(lua_gettop(L) - lc_nextra == 1);
      }
      lua_settop(L,(lc11 + lc_nextra));
    }
    lua_settop(L,(lc8 + lc_nextra));
  }
  lua_settop(L,(lc5 + lc_nextra));
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bees:bottle_honey',              50, 4, 1, beekeeper=3, tavern=1, inn=1, chest_storage=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,4);
  lua_pushliteral(L,"bees:bottle_honey");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,4);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"beekeeper");
  lua_pushnumber(L,3);
  lua_rawset(L,-3);
  lua_pushliteral(L,"tavern");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"inn");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bees:extractor',                 80, 1, 2, beekeeper=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bees:extractor");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"beekeeper");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bees:frame_empty',               50, 2, 5, beekeeper=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bees:frame_empty");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,5);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"beekeeper");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bees:frame_full',                80, 1, 1, beekeeper=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bees:frame_full");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"beekeeper");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bees:grafting_tool',             50, 1, 3, beekeeper=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bees:grafting_tool");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"beekeeper");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bees:hive_industrial',          100, 1, 1, beekeeper=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bees:hive_industrial");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,100);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"beekeeper");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bees:honey_comb',                50, 2, 2, beekeeper=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bees:honey_comb");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"beekeeper");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bees:queen_bee',                 50, 2, 3, beekeeper=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bees:queen_bee");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"beekeeper");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bees:smoker',                    80, 1, 2, beekeeper=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bees:smoker");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"beekeeper");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bees:wax',                       80, 3, 3, beekeeper=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bees:wax");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"beekeeper");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bushes:blackberry',              80, 20,  4, bakery=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bushes:blackberry");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,20);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,4);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"bakery");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bushes:blackberry_pie_cooked',   80, 12,  4, bakery=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bushes:blackberry_pie_cooked");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,12);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,4);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"bakery");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bushes:blueberry',               80, 20,  4, bakery=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bushes:blueberry");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,20);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,4);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"bakery");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bushes:blueberry_pie_cooked',    80, 12,  4, bakery=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bushes:blueberry_pie_cooked");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,12);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,4);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"bakery");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bushes:gooseberry',              80, 20,  4, bakery=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bushes:gooseberry");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,20);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,4);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"bakery");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bushes:gooseberry_pie_cooked',   80, 12,  4, bakery=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bushes:gooseberry_pie_cooked");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,12);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,4);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"bakery");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bushes:raspberry',               80, 20,  4, bakery=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bushes:raspberry");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,20);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,4);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"bakery");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bushes:raspberry_pie_cooked',    80, 12,  4, bakery=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bushes:raspberry_pie_cooked");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,12);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,4);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"bakery");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bushes:mixed_berry_pie_cooked',  80, 12,  4, bakery=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"bushes:mixed_berry_pie_cooked");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,12);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,4);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"bakery");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'bushes:sugar',                   80, 99,  5, bakery=1, shelf=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"bushes:sugar");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,99);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,5);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"bakery");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"shelf");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'carts:cart',                     80,  1,  2, miner=1}) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"carts:cart");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"miner");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'castle:battleaxe',               50,  1,  1, guard=1, forge=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"castle:battleaxe");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"guard");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'castle:ropebox',                 50,  2,  2, guard=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"castle:ropebox");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"guard");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'castle:ropes',                   50,  1,  1, guard=2, chest_private=1, chest_work=2 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"castle:ropes");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"guard");
  lua_pushnumber(L,2);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,2);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'castle:shield',                  50,  1,  1, guard=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"castle:shield");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"guard");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'castle:shield_2',                50,  1,  1, guard=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"castle:shield_2");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"guard");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'castle:shield_3',                50,  1,  1, guard=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"castle:shield_3");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"guard");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'cottages:anvil',                 80,  1,  2, forge=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"cottages:anvil");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'currency:minegeld',              80, 10,  2, chest_private=1, chest_work=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"currency:minegeld");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,10);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* -- TODO: could be in any chest with a certain chance
   * ADD_RCC({'farming:hoe_stone',              80,  1,  2, farm_tiny=2, farm_full=2, chest_work=2 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"farming:hoe_stone");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"farm_tiny");
  lua_pushnumber(L,2);
  lua_rawset(L,-3);
  lua_pushliteral(L,"farm_full");
  lua_pushnumber(L,2);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,2);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'homedecor:beer_mug',             50,  1,  2, tavern=5, inn=3}) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"homedecor:beer_mug");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"tavern");
  lua_pushnumber(L,5);
  lua_rawset(L,-3);
  lua_pushliteral(L,"inn");
  lua_pushnumber(L,3);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'homedecor:book_blue',            50,  1,  2, church=1, library=1, chest_private=1}) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"homedecor:book_blue");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'homedecor:book_red',             50,  1,  2, church=1, library=1, chest_private=1}) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"homedecor:book_red");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'homedecor:book_green',           50,  1,  2, church=1, library=1, chest_private=1}) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"homedecor:book_green");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'homedecor:bottle_brown',         50,  1,  2, tavern=3, inn=3, chest_private=1}) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"homedecor:bottle_brown");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"tavern");
  lua_pushnumber(L,3);
  lua_rawset(L,-3);
  lua_pushliteral(L,"inn");
  lua_pushnumber(L,3);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'homedecor:bottle_green',         50,  1,  2, tavern=3, inn=3, chest_private=1}) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"homedecor:bottle_green");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"tavern");
  lua_pushnumber(L,3);
  lua_rawset(L,-3);
  lua_pushliteral(L,"inn");
  lua_pushnumber(L,3);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({'homedecor:calendar',             50,  1,  1, church=1, library=1, chest_private=1, chest_work=1, chest_storage=1}) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,5);
  lua_pushliteral(L,"homedecor:calendar");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"homedecor:candle",               50,  2,  1, church=2, library=1, chest_private=1, chest_work=1, chest_storage=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,5);
  lua_pushliteral(L,"homedecor:candle");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,2);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"homedecor:candle_thin",          50,  2,  1, church=1, library=1, chest_private=1, chest_work=1, chest_storage=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,5);
  lua_pushliteral(L,"homedecor:candle_thin");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"homedecor:copper_pans",          80,  1,  1, chest_work=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"homedecor:copper_pans");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"homedecor:dardboard",            50,  1,  1, tavern=1}) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"homedecor:dardboard");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"tavern");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"homedecor:oil_extract",          80,  1,  3, church=1, library=1, chest_private=1, chest_work=1, chest_storage=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,5);
  lua_pushliteral(L,"homedecor:oil_extract");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,3);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"homedecor:oil_lamp",             50,  2,  1, church=1, library=1, chest_private=1, chest_work=1, chest_storage=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,5);
  lua_pushliteral(L,"homedecor:oil_lamp");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"homedecor:torch_wall",           50,  2,  1, church=1, library=1, chest_private=1, chest_work=1, chest_storage=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,5);
  lua_pushliteral(L,"homedecor:torch_wall");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"church");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"locks:key",                      50,  2,  1, chest_private=1, chest_work=1, chest_storage=1, forge=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,4);
  lua_pushliteral(L,"locks:key");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"locks:keychain",                 50,  2,  1, chest_private=1, chest_work=1, chest_storage=1, forge=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,4);
  lua_pushliteral(L,"locks:keychain");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,50);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"forge");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"moretrees:coconut_milk",         80,  5,  2, tavern=1, inn=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"moretrees:coconut_milk");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,5);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"tavern");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"inn");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"moretrees:raw_coconut",          80,  5,  2, tavern=1, inn=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"moretrees:raw_coconut");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,5);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,2);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"tavern");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"inn");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"moretrees:pine_nuts",            80, 99,  1, tavern=1, inn=1, chest_storage=3 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"moretrees:pine_nuts");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,99);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"tavern");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"inn");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,3);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"moretrees:spruce_nuts",          80, 99,  1, tavern=1, inn=1, chest_storage=3 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,3);
  lua_pushliteral(L,"moretrees:spruce_nuts");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,99);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"tavern");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"inn");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,3);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"quartz:quartz_crystal",          80,  1,  1, library=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"quartz:quartz_crystal");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"library");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"screwdriver:screwdriver",        80,  1,  1, chest_work=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,1);
  lua_pushliteral(L,"screwdriver:screwdriver");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"unified_inventory:bag_large",    80,  1,  1, chest_private=1, chest_storage=2 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"unified_inventory:bag_large");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,2);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"unified_inventory:bag_medium",   80,  1,  1, chest_private=1, chest_storage=2 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,2);
  lua_pushliteral(L,"unified_inventory:bag_medium");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_storage");
  lua_pushnumber(L,2);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* ADD_RCC({"unified_inventory:bag_small",    80,  1,  1, tavern=1, inn=1, chest_work=1, chest_private=1 }) */
  lua_pushvalue(L,(1 + lc_nextra));
  lua_createtable(L,4,4);
  lua_pushliteral(L,"unified_inventory:bag_small");
  lua_rawseti(L,-2,1);
  lua_pushnumber(L,80);
  lua_rawseti(L,-2,2);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,3);
  lua_pushnumber(L,1);
  lua_rawseti(L,-2,4);
  lua_pushliteral(L,"tavern");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"inn");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_work");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_pushliteral(L,"chest_private");
  lua_pushnumber(L,1);
  lua_rawset(L,-3);
  lua_call(L,1,0);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* -- get some random content for a chest
   * mg_villages.fill_chest_random = function( pos, pr, building_nr, building_typ )
   * 
   * 	local building_data = mg_villages.BUILDINGS[ building_nr.btype ];
   * 
   * 	local meta = minetest.env:get_meta( pos );
   * 	local inv  = meta:get_inventory();
   * 
   * 	-- bookshelves use "books" instead of "main" for their inventory
   * 	local inv_source = 'main';
   * 	-- which kind of content might be expected for this particular chest?
   * 	local typ = minetest.get_name_from_content_id( pos.typ );
   * 	if( pos.typ_name ) then
   * 		typ = pos.typ_name;
   * 	end
   * 	if(     typ == 'default:bookshelf') then
   * 		typ = 'chest_bookshelf';
   * 		inv_source = 'books';
   * 	elseif( typ == 'default:chest') then
   * 		typ = 'chest_default';
   * 	elseif( not( typ ) or (typ ~= 'cottages:shelf' and typ ~= 'cottages:chest_work' and typ ~= 'cottages:chest_storage' and typ ~= 'cottages:chest_private')) then
   * 		typ = building_data.typ;
   * 	else
   * 		typ = string.sub( typ, 10 );
   * 	end
   * 	local typ2 = nil;
   * 	if( typ == 'chest_work' and building_data.typ ) then
   * 		typ2 = building_data.typ;
   * 	end
   * 	if( not( typ ) or typ=='' ) then
   * 		return;
   * 	end
   * 	local inv_size = inv:get_size( inv_source );
   * 	mg_villages.fill_one_chest_random( pos, pr, typ, typ2, inv, inv_size, inv_source, building_nr, building_typ, building_data);
   * end */
  lua_pushcfunction(L,lcf1_mg_villages_fill_chest_random);
  lua_getfield(L,LUA_ENVIRONINDEX,"mg_villages");
  lua_insert(L,-2);
  lua_pushliteral(L,"fill_chest_random");
  lua_insert(L,-2);
  lua_settable(L,-3);
  lua_pop(L,1);
  assert(lua_gettop(L) - lc_nextra == 1);
  
  /* -- pos: position (x,y,z) of the chest that is to be filled
   * -- pr: pseudo-random number generator
   * -- typ: typ of the chest (i.e. chest_work, chest_default, chest_bookshelf, ...)
   * -- typ2: if the typ is chest_work, typ2 will contain the type of the building
   * -- inv: the inventory that is to be filled
   * -- inv_size: the size of the inventory that is to be filled
   * -- building_nr: number of the building inside the villages data structure
   * -- building_typ: i.e. house, farm, church, library, forge, ...
   * -- building_data: data about the building that contains the chest
   * mg_villages.fill_one_chest_random = function( pos, pr, typ, typ2, inv, inv_size, inv_source, building_nr, building_typ, building_data)
   * 
   * 	local count;
   * 	for i,v in ipairs( mg_villages.random_chest_content ) do
   * 
   * 		-- repeat this many times
   * 		for count=1, v[ 4 ] do
   * 
   * 			-- to avoid too many things inside a chest, lower probability
   * 			if(     count<30 -- make sure it does not get too much and there is still room for a new stack
   * 			 and (v[ typ ] or (typ2 and v[ typ2 ]))
   * 			 and inv_size and inv_size > 0 and v[ 2 ] > pr:next( 1, 200 )) then
   * 	
   * 				--inv:add_item('main', v[ 1 ].." "..tostring( math.random( 1, tonumber(v[ 3 ]) )));
   * 				-- add itemstack at a random position in the chests inventory 
   * 				inv:set_stack( inv_source, pr:next( 1, inv_size), v[ 1 ].." "..tostring( pr:next( 1, tonumber(v[ 3 ]) )) );
   * 				count = count+1;
   * 			end
   * 		end
   * 	end
   * end */
  lua_pushcfunction(L,lcf1_mg_villages_fill_one_chest_random);
  lua_getfield(L,LUA_ENVIRONINDEX,"mg_villages");
  lua_insert(L,-2);
  lua_pushliteral(L,"fill_one_chest_random");
  lua_insert(L,-2);
  lua_settable(L,-3);
  lua_pop(L,1);
  assert(lua_gettop(L) - lc_nextra == 1);
  return 0;
}


/* from lua.c */
static int traceback (lua_State *L) {
  if (!lua_isstring(L, 1))  /* 'message' not a string? */
    return 1;  /* keep it intact */
  lua_getfield(L, LUA_GLOBALSINDEX, "debug");
  if (!lua_istable(L, -1)) {
    lua_pop(L, 1);
    return 1;
  }
  lua_getfield(L, -1, "traceback");
  if (!lua_isfunction(L, -1)) {
    lua_pop(L, 2);
    return 1;
  }
  lua_pushvalue(L, 1);  /* pass error message */
  lua_pushinteger(L, 2);  /* skip this function and traceback */
  lua_call(L, 2, 1);  /* call debug.traceback */
  return 1;
}


static void lc_l_message (const char *pname, const char *msg) {
  if (pname) fprintf(stderr, "%s: ", pname);
  fprintf(stderr, "%s\n", msg);
  fflush(stderr);
}

static int lc_report (lua_State *L, int status) {
  if (status && !lua_isnil(L, -1)) {
    const char *msg = lua_tostring(L, -1);
    if (msg == NULL) msg = "(error object is not a string)";
    /*FIX-IMROVE:progname*/
    lc_l_message("lua", msg);
    lua_pop(L, 1);
  }
  return status;
}

static int lc_docall (lua_State *L, int narg, int clear) {
  int status;
  int base = lua_gettop(L) - narg;  /* function index */
  lua_pushcfunction(L, traceback);  /* push traceback function */
  lua_insert(L, base);  /* put it under chunk and args */
  /*FIX? signal(SIGINT, laction); */
  status = lua_pcall(L, narg, (clear ? 0 : LUA_MULTRET), base);
  /*FIX? signal(SIGINT, SIG_DFL); */
  lua_remove(L, base);  /* remove traceback function */
  /* force a complete garbage collection in case of errors */
  if (status != 0) lua_gc(L, LUA_GCCOLLECT, 0);
  return status;
}

static int lc_dofile (lua_State *L, const char *name) {
  int status = luaL_loadfile(L, name) || lc_docall(L, 0, 1);
  return lc_report(L, status);
}

static int lc_dostring (lua_State *L, const char *s, const char *name) {
  int status = luaL_loadbuffer(L, s, strlen(s), name) || lc_docall(L, 0, 1);
  return lc_report(L, status);
}

static int lc_handle_luainit (lua_State *L) {
  const char *init = getenv(LUA_INIT);
  if (init == NULL) return 0;  /* status OK */
  else if (init[0] == '@')
    return lc_dofile(L, init+1);
  else
    return lc_dostring(L, init, "=" LUA_INIT);
}


typedef struct {
  int c;
  const char ** v;
} lc_args_t;


/* create global arg table */
static void lc_createarg(lua_State * L, const lc_args_t * const args) {
  int i;
  lua_newtable(L);
  for (i=0; i < args->c; i++) {
    lua_pushstring(L, args->v[i]);
    lua_rawseti(L, -2, i);
  }
  lua_setglobal(L, "arg");
}


int lc_pmain_mod_mg_villages_fill_chest(lua_State * L) {
  luaL_openlibs(L);

  lua_pushcfunction(L, traceback);

  const int status1 = lc_handle_luainit(L);
  if (status1 != 0) return 0;

  /* note: IMPROVE: closure not always needed here */
  lua_newtable(L); /* closure table */
  lua_pushcclosure(L, lcf_main, 1);

  int status2 = lua_pcall(L, 0, 0, -2);
  if (status2 != 0) {
    const char * msg = lua_tostring(L,-1);
    if (msg == NULL) msg = "(error object is not a string)";
    fputs(msg, stderr);
  }
  return 0;
}



